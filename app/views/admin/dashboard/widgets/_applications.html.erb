<!-- Applications list with models. -->

<%
  page_title = Typus::I18n.t("Applications")
%>

<%
  # Detect if we are inside an application.
  if (application = params[:application])
    applications = [application]
    page_title = application
  else
    applications = admin_user.applications
  end
%>

<div class="page-heading padded clearfix">
  <h2><%= page_title %></h2>
</div>

<div class="padded">
<% if applications.any? %>
  <% applications.each do |app| %>

    <table>

      <% table_header = application ? "Models" : app %>

      <thead>
        <tr>
          <th><%= Typus::I18n.t(table_header) %></th>
        </tr>
      </thead>

      <% admin_user.application(app).map { |i| i.constantize }.each do |klass| %>
        <tr class="<%= cycle("even", "odd") %>">
          <td>
            <%= link_to klass.model_name.human.pluralize, :controller => "/admin/#{klass.to_resource}" %>
          </td>
        </tr>
      <% end %>

    </table>

  <% end %>
<% else %>
  <div class="notice">
    No applications detected.
  </div>
<% end %>
</div>
